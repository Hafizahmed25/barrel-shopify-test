import{l as A}from"./index.a394a8ae.js";import{c as T}from"./_commonjsHelpers.28e086c5.js";var I=function(n){var r=JSON.parse,i=JSON.stringify,f=window.localStorage,p=r(f.getItem(n))||{};return{get:b,set:v,remove:l,clear:h,exists:y};function m(){f.setItem(n,i(p))}function b(e){return p[e]||null}function v(e,t){p[e]=t,m()}function l(e){delete p[e],m()}function h(){f.removeItem(n)}function y(e){return b(e)!==null}};const O=I("promobar"),g=()=>new Date().getTime(),x=o=>Math.max(o.offsetHeight,o.scrollHeight,o.clientHeight),L=(o,...n)=>(n.forEach(r=>Object.keys(r).forEach(i=>o[i]=r[i])),o),P={content:()=>console.warn("promobar: content is undefined")},k=()=>{let o=document.createElement("div");return o.className="promobar-placeholder",o.style.height="0px",document.body.insertBefore(o,document.body.children[0]),o},H=()=>{let o=document.createElement("style");return document.body.insertBefore(o,document.body.children[0]),o},E=o=>O.set("root",{timestamp:new Date().getTime(),body:o}),B=(o,n)=>r=>{let i=O.get("root"),f=1e3*60*60*24;if(!i)return!0;let p=(r-i.timestamp)/f;return i.body!==n||p>=o},D=o=>o.forEach(n=>{n&&(Array.isArray(n)?n[1]()?n[0].setAttribute("data-promobar","true"):n[0].removeAttribute("data-promobar"):n.setAttribute("data-promobar","true"))}),S=(o,n=null)=>o.style.height=n?`${n}px`:"0px",j=(o,n={})=>{const r=A(),i=L({content:document.getElementById("promobarContent").innerHTML,resize:!0,placeholder:!0,offsets:[],close:Array.prototype.slice.call(document.querySelectorAll(".js-promobarClose")),lifespan:1},n);if(!i.content)return P.content();const f=B(i.lifespan,i.content),p=()=>typeof i.placeholder=="function"?i.placeholder():i.placeholder,m=i.offsets.length>0,b=k(),v=m?H():null,l={active:!1,enabled:f(g()),height:x(o)},h=(c=null)=>{p()?S(b,c):S(b),m&&(D(i.offsets),v.innerHTML=`[data-promobar] { ${c?`transform: translateY(${c}px) }`:"}"}`)},y=()=>{l.enabled&&(l.active=!0,h(l.height),o.classList.add("is-active"),document.body.classList.add("promobar-is-active"),r.emit("show",l))},e=(c=!1)=>{l.enabled&&(l.active=!1,c&&(E(i.content),l.enabled=f(g())),h(),o.classList.remove("is-active"),document.body.classList.remove("promobar-is-active"),r.emit("hide",l))},t=(c=!1)=>{if(!l.enabled)return;let a=x(o);(c||a!==l.height)&&(l.height=a,l.active?h(a):y(),r.emit("update",l))},s=()=>{O.remove("root"),l.enabled=f(g())};return i.resize&&window.addEventListener("resize",c=>t()),i.close.forEach(c=>c.addEventListener("click",a=>{a.preventDefault(),e(),E(i.content),l.enabled=f(g()),r.emit("disabled",l)})),{...r,hide:e,show:y,update:t,reset:s,getState:()=>l}};var N={};(function(o){(function(n,r){r(o);var i={};n.PubSub=i,r(i)})(typeof window=="object"&&window||T,function(n){var r={},i=-1;function f(e){var t;for(t in e)if(e.hasOwnProperty(t))return!0;return!1}function p(e){return function(){throw e}}function m(e,t,s){try{e(t,s)}catch(c){setTimeout(p(c),0)}}function b(e,t,s){e(t,s)}function v(e,t,s,c){var a=r[t],u=c?b:m,d;if(r.hasOwnProperty(t))for(d in a)a.hasOwnProperty(d)&&u(a[d],e,s)}function l(e,t,s){return function(){var a=String(e),u=a.lastIndexOf(".");for(v(e,e,t,s);u!==-1;)a=a.substr(0,u),u=a.lastIndexOf("."),v(e,a,t,s)}}function h(e){for(var t=String(e),s=Boolean(r.hasOwnProperty(t)&&f(r[t])),c=t.lastIndexOf(".");!s&&c!==-1;)t=t.substr(0,c),c=t.lastIndexOf("."),s=Boolean(r.hasOwnProperty(t)&&f(r[t]));return s}function y(e,t,s,c){var a=l(e,t,c),u=h(e);return u?(s===!0?a():setTimeout(a,0),!0):!1}n.publish=function(e,t){return y(e,t,!1,n.immediateExceptions)},n.publishSync=function(e,t){return y(e,t,!0,n.immediateExceptions)},n.subscribe=function(e,t){if(typeof t!="function")return!1;r.hasOwnProperty(e)||(r[e]={});var s="uid_"+String(++i);return r[e][s]=t,s},n.clearAllSubscriptions=function(){r={}},n.clearSubscriptions=function(t){var s;for(s in r)r.hasOwnProperty(s)&&s.indexOf(t)===0&&delete r[s]},n.unsubscribe=function(e){var t=typeof e=="string"&&r.hasOwnProperty(e),s=!t&&typeof e=="string",c=typeof e=="function",a=!1,u,d,w;if(t){delete r[e];return}for(u in r)if(r.hasOwnProperty(u)){if(d=r[u],s&&d[e]){delete d[e],a=e;break}if(c)for(w in d)d.hasOwnProperty(w)&&d[w]===e&&(delete d[w],a=!0)}return a}})})(N);const M=o=>{const n=j(o);setTimeout(n.show,4e3),window.promobar=n};export{M as default};
//# sourceMappingURL=promobar.ed6d1257.js.map
